# ============================================================================
# Configurazione S3 per MioSaaS - Gestione File Multi-Tenant
# ============================================================================
# Copia questo file in .env e configura i valori per il tuo ambiente
# ============================================================================

# ============================================================================
# CONFIGURAZIONE S3 BUCKET
# ============================================================================

# Nome del bucket S3 (es: miosaas-files-prod, miosaas-files-dev)
S3_BUCKET_NAME=miosaas-files-dev

# Regione AWS per il bucket S3
S3_REGION=eu-north-1

# Algoritmo di encryption (AES256 o aws:kms)
S3_ENCRYPTION=AES256

# Abilita versioning per audit trail
S3_VERSIONING=true

# Abilita CORS per accesso frontend
S3_CORS_ENABLED=true

# ============================================================================
# CONFIGURAZIONE IAM
# ============================================================================

# ARN del role IAM per accesso S3
AWS_ROLE_ARN=arn:aws:iam::ACCOUNT_ID:role/MioSaaSBackendS3Role

# Regione AWS per IAM
AWS_REGION=eu-north-1

# ============================================================================
# CONFIGURAZIONE UPLOAD FILE
# ============================================================================

# Dimensione massima file (es: 100MB, 500MB, 1GB)
MAX_FILE_SIZE=100MB

# Tipi MIME consentiti (separati da virgola)
ALLOWED_MIME_TYPES=image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,application/json

# Scadenza presigned URL per upload (secondi)
UPLOAD_EXPIRY_SECONDS=3600

# Scadenza presigned URL per download (secondi)
PRESIGNED_URL_EXPIRY=3600

# ============================================================================
# CONFIGURAZIONE SICUREZZA
# ============================================================================

# Abilita bucket key per ridurre costi encryption
S3_BUCKET_KEY_ENABLED=true

# Abilita Intelligent Tiering per ottimizzazione costi
S3_INTELLIGENT_TIERING=true

# ============================================================================
# CONFIGURAZIONE LIFECYCLE
# ============================================================================

# Abilita lifecycle rules per gestione automatica costi
S3_LIFECYCLE_ENABLED=true

# Giorni prima di spostare in STANDARD_IA
S3_ARCHIVE_AFTER_DAYS=90

# Giorni prima di spostare in GLACIER
S3_GLACIER_AFTER_DAYS=365

# Giorni prima di eliminare definitivamente
S3_DELETE_AFTER_DAYS=2555

# ============================================================================
# CONFIGURAZIONE MONITORING
# ============================================================================

# Abilita CloudWatch monitoring
S3_CLOUDWATCH_ENABLED=true

# Nome dashboard CloudWatch
S3_CLOUDWATCH_DASHBOARD=MioSaaS-S3-Monitoring

# Abilita metriche S3
S3_METRICS_ENABLED=true

# ============================================================================
# CONFIGURAZIONE BACKUP E DISASTER RECOVERY
# ============================================================================

# Abilita replica cross-region
S3_CROSS_REGION_REPLICATION=false

# Regione destinazione per replica
S3_REPLICATION_DESTINATION_REGION=eu-west-1

# Bucket destinazione per replica
S3_REPLICATION_DESTINATION_BUCKET=

# ============================================================================
# CONFIGURAZIONE AVANZATE
# ============================================================================

# Abilita compressione automatica
S3_COMPRESSION_ENABLED=false

# Abilita scansione antivirus (se configurato)
S3_ANTIVIRUS_ENABLED=false

# Abilita watermarking automatico
S3_WATERMARKING_ENABLED=false

# ============================================================================
# CONFIGURAZIONE TENANT
# ============================================================================

# Abilita quota per tenant
S3_TENANT_QUOTA_ENABLED=true

# Quota massima per tenant (es: 10GB, 100GB)
S3_TENANT_MAX_QUOTA=10GB

# Abilita isolamento tenant rigoroso
S3_STRICT_TENANT_ISOLATION=true

# ============================================================================
# CONFIGURAZIONE NOTIFICHE
# ============================================================================

# Abilita notifiche SNS per eventi S3
S3_SNS_NOTIFICATIONS_ENABLED=false

# ARN topic SNS per notifiche
S3_SNS_TOPIC_ARN=

# ============================================================================
# CONFIGURAZIONE CORS
# ============================================================================

# Origini consentite per CORS (separate da virgola)
S3_CORS_ALLOWED_ORIGINS=https://app.miosaas.it,https://*.miosaas.it,http://localhost:3000

# Metodi HTTP consentiti per CORS
S3_CORS_ALLOWED_METHODS=GET,PUT,POST,DELETE

# Headers consentiti per CORS
S3_CORS_ALLOWED_HEADERS=*

# Max age per preflight CORS (secondi)
S3_CORS_MAX_AGE=3000

# ============================================================================
# CONFIGURAZIONE PERFORMANCE
# ============================================================================

# Dimensione chunk per multipart upload (es: 5MB, 10MB)
S3_MULTIPART_CHUNK_SIZE=5MB

# Numero massimo parti per multipart upload
S3_MAX_MULTIPART_PARTS=10000

# Timeout per operazioni S3 (millisecondi)
S3_OPERATION_TIMEOUT=30000

# ============================================================================
# CONFIGURAZIONE CACHE
# ============================================================================

# Abilita cache locale per metadati file
S3_METADATA_CACHE_ENABLED=true

# TTL cache metadati (secondi)
S3_METADATA_CACHE_TTL=300

# Dimensione massima cache metadati (MB)
S3_METADATA_CACHE_MAX_SIZE=100

# ============================================================================
# CONFIGURAZIONE LOGGING
# ============================================================================

# Abilita logging accessi S3
S3_ACCESS_LOGGING_ENABLED=false

# Bucket destinazione per log accessi
S3_ACCESS_LOGGING_BUCKET=

# Prefisso per log accessi
S3_ACCESS_LOGGING_PREFIX=access-logs/

# ============================================================================
# NOTE IMPORTANTI
# ============================================================================
# 1. Sostituisci ACCOUNT_ID con il tuo AWS Account ID
# 2. Configura le dimensioni file in base alle tue esigenze
# 3. Verifica i tipi MIME consentiti per la tua applicazione
# 4. Testa la configurazione in ambiente di sviluppo prima
# 5. Monitora i costi S3 dopo l'implementazione
# 6. Configura backup e disaster recovery per produzione
# ============================================================================
